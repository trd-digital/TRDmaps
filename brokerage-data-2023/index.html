<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Sample of BootStrap Table that render CSV file</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <!-- bootstrap itself -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/css/bootstrap.min.css"
        integrity="sha256-7ZWbZUAi97rkirk4DcEp4GWDPkWpRMcNaEyXGsNXjLg=" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/js/bootstrap.bundle.min.js"
        integrity="sha256-wMCQIK229gKxbUg3QWa544ypI4OoFlC2qQl8Q8xD8x8=" crossorigin="anonymous"></script>
    <!-- jquery needed for bootstrap-table-->
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js"
        integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
    <!-- bootstrap-table-->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-table@1.20.2/dist/bootstrap-table.min.css"
        integrity="sha256-LeU0tzGXsUojxMQgTdjRB74+q8RQhqUQoobY4+76cY8=" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap-table@1.20.2/dist/bootstrap-table.min.js"
        integrity="sha256-lQSRQ2EUXUKg2xkKTV+D0E3rACEAi1aI+809LI5drdc=" crossorigin="anonymous"></script>
    <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-table/1.21.4/extensions/filter-control/bootstrap-table-filter-control.min.css"
        integrity="sha512-3wnb7LWbjgtAbFFhszzC2PrPQ5fo1OnqRJHd9QYn+8UCMWMqQQrl5BZBJQx+cluqVIaszGF0MyEefoMC0Izxqg=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
    <script
        src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-table/1.21.4/extensions/filter-control/bootstrap-table-filter-control.min.js"
        integrity="sha512-/h89z5K7yzd1hIhw94drUJKivJcDQ3e93pKwC9bxLgWWhO+cD0RxCplr6tccXu3S1gbowNTsPFcVt+KMdGLdKw=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-table/1.21.4/extensions/filter-control/utils.min.js"
        integrity="sha512-k7gAbgw7/TU4yrD6bbDMFpWSUnFeTaopF7PnmASKWFMM3E9pmRTCEnBpu4UXfyOlX6yh7PiqNoTwgO368jEbZA=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>

    <script>
        function responseHandlerCsvWithoutHeader(csvText) {
            // we should specify column names manually
            let headers = ['source_doc_id', 'recorded_date', 'doc_date', 'doc_amount', 'borough', 'addresses', 'units',
                'bbl',
                'new_dev_sale_type', 'property_group', 'property_type', 'neighborhood', 'Brokerage', 'link_url'
            ]

            return responseHandlerCsvToJsonHeaders(csvText, headers);
        }
    </script>
</head>
<h2>2022 Brokerage Ranking</h2>
<table id="table" data-toggle="table" data-pagination="true" data-page-size="10" data-escape="true"
    data-response-handler="responseHandlerCsvToJson" data-search="true" data-sortable="true" data-sort-reset-page="true"
    data-data-type="text" data-show-columns="true" data-show-search-clear-button="false" data-url="data.csv">
    <thead>
        <tr>
            <th data-field="source_doc_id">Source ID</th>
            <th data-field="recorded_date" data-sortable="true">Recorded Data</th>
            <th data-field="doc_date" data-sortable="true">Document ID</th>
            <th data-field="doc_amount" data-sortable="true">Document Amount</th>
            <th data-field="borough" data-sortable="true">Borough</th>
            <th data-field="addresses" data-sortable="true">Addresses</th>
            <th data-field="source_doc_id" data-sortable="true">Source Document ID</th>
            <th data-field="recorded_date" data-sortable="true">Record Date</th>
            <th data-field="units" data-sortable="true">Units</th>
            <th data-field="bbl" data-sortable="true">BBL</th>
            <th data-field="new_dev_sale_type" data-sortable="true">Development Type</th>
            <th data-field="property_group" data-sortable="true">Proprty Group</th>
            <th data-field="property_type" data-sortable="true">Property Type</th>
            <th data-field="neighborhood" data-sortable="true">Neighborhood</th>
            <th data-field="Brokerage" data-sortable="true">Brokerage</th>
            <th data-field="link_url" data-sortable="true" data-formatter="nameFormatter">Link</th>
        </tr>
    </thead>
</table>
</body>

</html>

<script>
    function responseHandlerCsvToJson(csvText) {
        let csvLines = csvText.split("\n")
        if (csvLines.length <= 1) {
            return {
                rows: []
            }
        }
        let headers = csvLines[0].split(",")
        return csvLinesToJsonRows(csvLines.slice(1), headers);
    }

    function responseHandlerCsvToJsonHeaders(csvText, headers) {
        let csvLines = csvText.split("\n")
        return csvLinesToJsonRows(csvLines, headers);
    }

    function csvLinesToJsonRows(csvLines, headers) {
        let jsonRows = []
        for (let csvLineIdx = 0; csvLineIdx < csvLines.length; csvLineIdx++) {
            let csvLine = csvLines[csvLineIdx]
            if (!csvLine) {
                continue
            }
            let fields = csvLine.split(",")
            let row = {}
            if (fields.length === 0) {
                continue
            }
            for (let headerIdx = 0; headerIdx < headers.length; headerIdx++) {
                let header = headers[headerIdx]
                if (fields.length > headerIdx) {

                    row[header] = fields[headerIdx];

                }
            }
            jsonRows[csvLineIdx] = row
        }
        return {
            rows: jsonRows
        }
    }

    function nameFormatter(value, row) {
        var icon = row.id % 2 === 0 ? 'fa-star' : 'fa-star-and-crescent'
        return '<a class="fa" target="_blanl" href="' + icon + '">Link</a>'
    }
</script>
<style>
    h2 {
        font-weight: bold;
        float: left;
        font-family: Merriweather, serif;
        font-size: 1.5rem;
        padding: 15px 10px;

    }

    th {
        text-transform: uppercase;
        font-size: .75rem;
        color: #7d7d7d;
        padding: 0.8rem 0rem !important;
        white-space: nowrap;
    }
</style>